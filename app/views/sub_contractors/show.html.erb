<p id="notice"><%= notice %></p>

<h1>Subcontractor</h1>

<p>
  <strong><%= @sub_contractor.name %></strong>
</p>
<p>
  <strong>Tasks:</strong>
  <span><%= @sub_contractor.tasks.length%></span>
</p>

<% if @sub_contractor.tasks.any? %>
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Job</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @sub_contractor.tasks.each do |task| %>
        <% if we_have_permission_for_job?(task.job) %>
          <tr>
            <td><%= task.title %></td>
            <td><%= link_to task.job.title, task.job %></td>
            <td><%= link_to 'Show', task %></td>
            <td><%= link_to 'Edit', edit_task_path(task) %></td>
            <td><%= link_to 'Destroy', task, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% else %>
          <tr>You do not have permission to view this task</tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
<% end %>
<br>

<% if logged_in? %>
  <%= link_to 'Edit', edit_sub_contractor_path(@sub_contractor) %> |
  <%= link_to 'Destroy', @sub_contractor, method: :destroy, data: { confirm: 'Are you sure?' } %>
  <br>
<% end%>

<%= link_to 'All Subcontractors', sub_contractors_path %>